{% extends "rss_app/base.html" %}

{% block content %}

<p>Source Details</p>
<p><a href="{{ source.url }}">Title: {{ source.title }}</a></p>
<p>{{ source.last_fetched }}</p>

<form action="{% url 'fetch' source.id %}" method="post">
  {% csrf_token %}
  <input type="submit" value="Fetch" />
</form>

<div class="accordion" id="accordionExample" style="max-width: 768px">

<h3>Items</h3>
{% for item in items %}
<hr/>
<h4><a href="{{item.url}}">{{item.title}}</a></h4>

<p>{% if item.author|length > 1 %}{{ item.author }} - {% endif %}{{ item.pub_date }}</p>

{% if item.content|length < 900 %}
<p>{% autoescape off %}
  {{ item.content }}
{% endautoescape %}</p>
{% else %}

  <div class="accordion-item">
    <h2 class="accordion-header">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ forloop.counter0 }}" aria-expanded="true" aria-controls="collapse{{ forloop.counter0 }}">
        {{ item.guid }}
      </button>
    </h2>
    <div id="collapse{{ forloop.counter0 }}" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
      <div class="accordion-body"><div class="container container-sm">
        {% autoescape off %}{{ item.content }}{% endautoescape %}
      </div></div>
    </div>
  </div>
  
{% endif %}

{% endfor %}
</div>

{% endblock %}
